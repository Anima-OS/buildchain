{
    "name": "buildchain",
    "base": "ubuntu:16.04",
    "source": {
        "kind": "git",
        "url": "https://github.com/system76/buildchain.git"
    },
    "commands": [
        ["apt-get", "install", "-y", "gcc"],
        ["wget", "https://sh.rustup.rs", "-O", "rustup.sh"],
        ["chmod", "+x", "rustup.sh"],
        ["./rustup.sh", "-y", "--default-toolchain", "nightly"],
        ["mkdir", "sysroot"],
        ["bash", "-c", "source .cargo/env && cargo install --path source --root sysroot"],
        ["tar", "--create", "--mtime=@${BUILDCHAIN_TIME}", "--xz", "--file", "artifacts/buildchain.tar.xz", "--directory", "sysroot", "."]
    ]
}
